{
  "meta": {
    "name": "core_sqli_rules",
    "tags": ["core", "sqli"]
  },
  "rules": [
    { "id": 101, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "('|\\\"|`|´)(\\s*or\\s*|\\|\\|)\\s*\\1[a-zA-Z0-9]+\\1\\s*=\\s*\\1[a-zA-Z0-9]+\\1", "action": "DENY", "score": 50 },
    { "id": 102, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "(?i)(?:\\b|(?<=\\d))union\\s+(all\\s+)?select\\b", "action": "DENY", "score": 40 },
    { "id": 103, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "(?i)(?:\\b|(?<=\\d))select\\s+.+\\s+from\\b", "action": "DENY", "score": 30 },
    { "id": 104, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "(?i)(?:\\b|(?<=\\d))(information_schema|pg_catalog|mysql\\.user)\\b", "action": "DENY", "score": 40 },
    { "id": 105, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "(?i)\\b(group_concat|load_file|benchmark|user_password|concat_ws|char|ascii|substring|cast|convert|database|sleep|xp_cmdshell|sp_executesql|JSON_EXTRACT)\\s*\\(", "action": "DENY", "score": 35 },
    { "id": 106, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "(\\s*(like|rlike|regexp)\\s*(char|0x))", "action": "DENY", "score": 25 },
    { "id": 107, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "(?i)\\(\\s*select\\s*.*?\\s*from\\s*.*?\\s*(sleep|benchmark)\\s*\\(", "action": "DENY", "score": 40 },
    { "id": 108, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "('\\)|\\\"\\)|`\\)|´\\))\\s*(and|or|\\|\\||&&)\\b", "action": "DENY", "score": 45 },
    { "id": 110, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "(union|select|insert|update|delete|from|where).*?(#|--|;)", "action": "DENY", "score": 20 },
    { "id": 111, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "/\\*!\\d*\\s*(union|select|insert|update|delete|from|where)\\b", "action": "DENY", "score": 30 },
    { "id": 112, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "(?i)(?:\\b|(?<=\\d))union(%20|\\+)+(all(%20|\\+)+)?select\\b", "action": "DENY", "score": 40 },
    { "id": 113, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "(?i)(?:\\b|(?<=\\d))select(%20|\\+)+.+(%20|\\+)+from\\b", "action": "DENY", "score": 30 },
    { "id": 114, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "(?i)(?:\\b|(?<=\\d))(group_concat|load_file|benchmark|sleep)\\s*(%28|\\()", "action": "DENY", "score": 35 },
    { "id": 115, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "\\\\u0025", "action": "DENY", "score": 10 },
    { "id": 116, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "\\\\u0025(\\\\u0032\\\\u0037|\\\\u0032\\\\u0032)", "action": "DENY", "score": 20 },
    { "id": 117, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "\\\\u0025(\\\\u0032\\\\u0038|\\\\u0032\\\\u0039|\\\\u0032\\\\u0066|\\\\u0032\\\\u0061|\\\\u0032\\\\u0064)", "action": "DENY", "score": 30 },
    { "id": 118, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "\\\\u0025(\\\\u0032\\\\u0035)", "action": "DENY", "score": 20 },
    { "id": 120, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "(?i)/\\*!.*?(s|%[57]3)(e|%[46]5)(l|%[46]c)(e|%[46]5)(c|%[46]3)(t|%[57]4).*?\\*/", "action": "DENY", "score": 45 },
    { "id": 121, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "(?i)/\\*!.*?(u|%[57]5)(n|%[46]e)(i|%[46]9)(o|%[46]f)(n|%[46]e).*?\\*/", "action": "DENY", "score": 45 },
    { "id": 122, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "(?i)1'\\s*or\\s*'1'\\s*=\\s*'1", "action": "DENY", "score": 5 },
    { "id": 123, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "(%2527|%2525|%2528|%2529|%252a|%252b|%252c|%252e|%252f|%253a|%253b|%253c|%253d|%253e|%253f|%2540|%255b|%255c|%255d|%255e|%255f|%2560|%257b|%257d|%257e)", "action": "DENY", "score": 10, "caseless": true },
    { "id": 124, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "(%25%32%27|%25%32%25|%25%32%28|%25%32%29|%25%32%2a|%25%32%2b|%25%32%2c|%25%32%2e|%25%32%2f|%25%32%3a|%25%32%3b|%25%32%3c|%25%32%3d|%25%32%3e|%25%32%3f|%25%32%40|%25%32%5b|%25%32%5c|%25%32%5d|%25%32%5e|%25%32%5f|%25%32%60|%25%32%7b|%25%32%7d|%25%32%7e)", "action": "DENY", "score": 10, "caseless": true },
    { "id": 125, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "\\\\s*AND\\\\s*JSON_DEPTH\\\\s*\\('{.*?}'\\\\s*\\)", "action": "DENY", "score": 30 },
    { "id": 126, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "\\\\s*JSON_EXTRACT\\\\s*\\('{.*?}'\\\\s*,\\\\s*'.*?'\\\\s*\\)", "action": "DENY", "score": 30 },
    { "id": 127, "tags": ["core", "sqli"], "target": ["URI", "ARGS_COMBINED", "BODY"], "match": "REGEX", "pattern": "JSON_EXTRACT%28'%7B''aKER''%3A%209648%7D'%2C%20'%24\\\\.aKER'%29", "action": "DENY", "score": 30 }
  ]
}



